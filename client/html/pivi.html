<html>
  <head>

<meta name='apple-mobile-web-app-capable' content='YES' />
<meta name="viewport" content="width=device-width,initial-scale=1">

    <title>PiVi Jukebox</title>
    <script type="text/javascript" src="../js/jquery-1.6.2.js"></script>
    <script  type="text/javascript" src="../js/jquery-ui-1.11.4/jquery-ui.js"></script>
    <!-- <style>
      body { 
          background-color:#ccc;
          font-family: Calibri, arial, helvetica;
      }

      .header, .addfile {
          font:bold 20px helvetica;
          color: #333;
          text-shadow: -1px -1px 1px #fff;
      }

      .addfile {
          float:right;
          margin-right:10px;
      }

      .list div {
          background-color:#fff;
          margin:4px;
          min-height:40px;
          padding:3px;
          border-radius:5px;
          -webkit-box-shadow: 0px 1px 2px #444;
          box-shadow: 1px 1px 2px #444;
     }

      #np { 
          position:fixed;
          background-color:#ddd;
          right:0px;
          top:0px;
          left:0px;
          padding:3px;
          -webkit-box-shadow: 0px 1px 1px #444;
          box-shadow: 1px 1px 1px #444;
      }
      
      #npshadow {
          min-height:42px;
      }

      #stop, #edit { 
          background-color: rgba( 255,255,255,0.5);
          float:left;
          margin:4px;
          min-height:25px;
          padding:3px;
          border-radius:5px;
      }

      #edit {
          float:right;
      }

      #playing { 
          background-color: rgba( 243,243,200,0.5);
          margin:4px;
          font-size:11px;
          min-height:25px;
          padding:3px;
          border-radius:5px;
      }

    </style> -->

    <style>
      @font-face {
	  font-family: Okuda;
	  src: url("../fonts/okuda/Okuda.otf") format("opentype");
      }
      @font-face {
          font-family:Okuda;
	  font-face: bold;
          src: url("../fonts/okuda/Okuda Bold.otf") format("opentype");
      }
      body { 
          background-color:#000;
          font-family: Okuda,  Calibri, arial, helvetica;
	  font-size: 40px;
      }

      .header, .headerbutton, .footer, .lefter, .footertall,.headerblack {
          color: #000;
	  background-color: rgba(200,225,250,1);
	  font-family: bold Okuda 25pt;
          margin:4px;
          height:50px;
          padding:3px;
	  padding-left:10px;
          border-top-left-radius:20px;
      }

      .headerblack {
	  background-color: black;
	  color: rgba(186,171,98,1);
      }

      .lefter {
	  float:left;
	  width: 12px;
	  height:46px;
	  margin-top:0px;
	  margin-right:10px;
	  border-radius:0px;
      }
      .footer {
          margin:4px;
          height:20px;
          padding:3px;
	  padding-left:10px;
	  margin-bottom:20px;
          border-bottom-left-radius:20px;
	  border-top-left-radius:0px;
      }

      .footertall {
          border-bottom-left-radius:20px;
	  border-top-left-radius:0px;
      }	  

      .headerbutton {
          float:right;
          margin-right:10px;
	  margin-top:0px;
	  height:30px;
      }

      .gap {
	  background-color: rgba(0,0,0,1);
          float:right;
	  width:4px;
          margin-right:4px;
	  height:57px;
      }
      .item {
	  color:#000;
          background-color: rgba(100,150,250,1);
          margin:4px;
 	  margin-left:40px;
	  margin-right:40px;
          min-height:40px;
          padding:3px;
	  padding-left:10px;
          border-top-right-radius:10px;
	  border-bottom-right-radius:10px;
     }

      #nowplaying { 
          position:fixed;
          background-color:#ddd;
          right:0px;
          top:0px;
          left:0px;
          padding:3px;
          -webkit-box-shadow: 0px 1px 1px #444;
          box-shadow: 1px 1px 1px #444;
      }
      
      #npshadow {
          min-height:42px;
      }

      #stop, #edit { 
          background-color: rgba( 255,255,255,0.5);
          float:left;
          margin:10px;
          min-height:25px;
          padding:3px;
          border-radius:5px;
      }

      #edit {
          float:right;
      }

      #playing { 
          background-color: rgba( 243,243,200,0.5);
          margin:4px;
          font-size:11px;
          min-height:45px;
          padding:3px;
          border-radius:5px;
      }

      #videos {
	  margin-top: 30px;
      }
    </style>      


    <script type="text/javascript">

      jQuery(document).ready( function() {
          $ = jQuery;


          function play(file) {
              $.get("/play", {filename:file}, function (data) {
                  var names = data.playing.split('/');
//                  jQuery('#playing').html(names[0]+': ' + names[1].match(/.*?(?=-\S)/));
                    jQuery('#playing').html( names[1].match(/.*?(?=-\S)/));
              }
              , "json");
          }

          function listVideos(videoListing,element) {
              videoListing.forEach( function (directory) {
                  $(element).append('<div class="headerbutton" dir="' + directory.directory + '">ADD</div><div class="gap"></div><div class="header">' + directory.directory + '</div>');
                  var category = $('<div class="list"></div>').appendTo($(element));
                  directory.files.forEach( function(video) {
                      videoTitle = video.match(/.*?(?=-\S)/);
	              category.append("<div class='lefter'></div><div class='item' file=\"" + directory.directory +'/' +video + "\">" + videoTitle + "</div>");
                  })
		  $(element).append('<div class="footer"></div>');
              });
              $('.list').click( function(e) {
                  play($(e.srcElement).attr("file"));
              });
	  }          

          function getListing() {
              $.get("/dir", {},
                  function (data) { 
                      listVideos(data,"#videos")
                  }, "json");
          }

	  getListing();

           $('#stop').click( function(e) {
                  play("stop");
                  jQuery('#playing').html("");
           });

/*           function scrollDiv(element) {
               element= '#playing';
               $(element).css("left", $(element).css("left")-1);
               if ($(element).css("left") < -200) {
                  $(element).css("left", 0) 
               }
           }
           setInterval(scrollDiv,200);
*/

	});


    </script>
  </head>
  <body>
    <div class='lefter'></div><div class='headerblack'> now playing....</div>
    <div class="headerbutton">EDIT</div><div class="gap"></div>    <div class="headerbutton">STOP</div><div class="gap"></div><div class="footertall"></div>
    <div id="videos"></div>
  </body>
  
</html>
